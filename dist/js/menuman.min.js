function MenuMan(t){var e=this;this.menuBoardEl,this.menuBoards={},this.menus={},this.nowSelectedObjId="",this.nowSelectedElement,this.isShown=!1,this.theme,this.target,this.lastPosX,this.lastPosY,window.addEventListener("contextmenu",function(t){e.handleOpenContextMenu(t)}),window.addEventListener("mousedown",function(t){e.handleCloseContextMenu(t)}),getEl(document).addEventListener("keydown",function(t){var n=t.keyCode?t.keyCode:t.which;27==n&&e.handleCloseContextMenu(t)})}try{var crossman=require("@sj-js/crossman"),ready=crossman.ready,getEl=crossman.getEl,newEl=crossman.newEl,getData=crossman.getData,SjEvent=crossman.SjEvent}catch(e){}try{module.exports=exports=MenuMan}catch(e){}MenuMan.prototype.setTheme=function(t){return this.theme=t,this},MenuMan.prototype.addMenuBoard=function(t,e,n){return this.menuBoards[t]={conObj:e,menus:n},this},MenuMan.prototype.addMenu=function(t,e,n){return this.menus[t]={el:this.getNewMenuEl(t,e),func:n},this},MenuMan.prototype.handleOpenContextMenu=function(t){var e=this.menuBoards;if(!(t.which&&3==t.which||t.button&&2==t.button))return!1;this.setPos(t);for(var n in e){var s=e[n];if(this.isMatch(this.target,s.conObj))return t.preventDefault(),t.stopPropagation(),this.nowSelectedElement=this.target,void this.showMenuBoard(s.menus)}},MenuMan.prototype.handleCloseContextMenu=function(){if(this.isShown&&this.menuBoardEl){for(var t=this.menuBoardEl;t.firstChild;)t.removeChild(t.firstChild);t.style.zIndex=0,t.style.display="none"}this.nowSelectedObjId="",this.isShown=!1},MenuMan.prototype.setPos=function(t){this.target=t.target,this.lastPosX,this.lastPosY,void 0!=t.touches?(this.lastPosX=t.touches[0].pageX,this.lastPosY=t.touches[0].pageY):(this.lastPosX=t.clientX,this.lastPosY=t.clientY),void 0!=t.touches?(timerTime>=3&&t.preventDefault(),this.target=t.touches[0].target):this.target=t.target},MenuMan.prototype.isMatch=function(t,e){var n=!1;return n=getEl(t).findDomAttribute(e)},MenuMan.prototype.showMenuBoard=function(t){var e=this;this.menus;this.isShown&&e.handleCloseContextMenu(),this.menuBoardEl||(this.menuBoardEl=newEl("div").addClass("menuman-menu-board").addEventListener("mousewheel",function(t){t.preventDefault(),t.stopPropagation()}).returnElement());var n=this.menuBoardEl;this.theme||(this.theme="none"),n.setAttribute("data-theme",this.theme);for(var s=0;s<t.length;s++){var o=t[s],i=this.menus[o];getEl(n).add(i.el)}n&&(this.isShown=!0,n.style.display="block",n.style.position="absolute",n.style.left=this.lastPosX+12+"px",n.style.top=this.lastPosY+2+"px",n.style.zIndex=getData().findHighestZIndex(["div"])+1,getEl(document.body).add(n))},MenuMan.prototype.getNewMenuEl=function(t,e){var n=this,s=newEl("div").addClass("menuman-menu").html(e).addEventListener("mousedown",function(e){e.preventDefault(),e.stopPropagation();var s=n.nowSelectedElement;n.handleCloseContextMenu(),n.menus[t].func(s)}).returnElement();return s};